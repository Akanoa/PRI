<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OpenViBE documentation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<!-- <link href="tabs.css" rel="stylesheet" type="text/css"> -->
</head>
<body>
<div id="main">
	<div id="title">
		<center>
		<a name="page-top"></a>
		<table width=95%>
			<tr>
				<td><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;"><img src="logo.png" /></a></td>
				<td width=100%>OpenViBE Documentation</td>
			</tr>
		</table>
		</center>
	</div>
	<div id="menu">
		<div id="menu-content">
			<ul>
				<li><a href="index.html">OpenViBE Documentation</a></li>
			</ul>
			<div class="menu-title">Doxygen</div>
			<ul>
				<!-- <li><a href="pages.html">Related</a></li> -->
				<li><a href="modules.html">Modules</a></li>
				<li><a href="namespaces.html">Namespaces</a></li>
				<li><a href="annotated.html">Class List</a>
				<li><a href="classes.html">Class Index</a>
				<li><a href="hierarchy.html">Class Hierarchy</a>
				<!-- <li><a href="files.html">Files (buggy)</a></li> -->
			</ul>
			<div class="menu-title">Quick Access</div>
			<ul>
				<li><a href="http://openvibe.inria.fr/start" class="leaving-link">Video Tutorials</a></li>
				<li><a href="http://openvibe.inria.fr/faq">FAQ</a></li>
				<li><a href="http://openvibe.inria.fr/license">Licence</a></li>
				<li><a href="http://openvibe.inria.fr/build-instructions/">Build Instructions</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#User+Documentation">User Doc</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#Developer+Documentation">Developer Doc</a></li>
				<li><a href="Doc_BoxAlgorithms.html">Exisiting Boxes</a></li>
			</ul>
			<div class="menu-title">Contact</div>
			<ul>
				<li><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;">Software Home</a></li>
				<li><a href="http://openvibe.inria.fr/forum" class="leaving-link" onclick="window.open(this.href,'openvibe-forum'); return false;">Forum</a></li>
				<li><a href="https://gforge.inria.fr/projects/openvibe" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">INRIA gForge</a></li>
				<li><a href="https://gforge.inria.fr/mail/?group_id=276" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">Mailing Lists</a></li>
				<li><a href="http://openvibe.inria.fr/tracker" class="leaving-link" onclick="window.open(this.href,'openvibe-tracker'); return false;">Bug Tracker</a></li>
				<li><a href="http://www.irisa.fr/bunraku/OpenViBE/wiki/index.php?title=Main_Page" class="leaving-link" onclick="window.open(this.href,'openvibe-wiki'); return false;">Research Project</a></li>
				<li><b>IRC</b> : <span style="font-size: x-small; font-style: italic;">#openvibe</span> on <span style="font-size: x-small; font-style: italic;">irc.freenode.net</span></li>
				<li><b>Project Leader</b> : Anatole L&eacute;cuyer, Inria <span style="font-size: x-small; font-style: italic;">(anatole dot lecuyer at inria dot fr)</span></li>
				<li><b>Lead Software Engineer</b> : Laurent Bonnet, Inria <span style="font-size: x-small; font-style: italic;">(laurent dot bonnet at inria dot fr)</span></li>
			</ul>
			<div class="menu-title">Share this</div>
			<ul><li><span style="font-size: x-small; font-style: italic;">This documentation is licenced under <b>CC-BY-SA</b></span></li></ul>
			<td><a href="http://creativecommons.org/licenses/by-sa/3.0/legalcode" class="leaving-link" onclick="window.open(this.href,'cc-by-sa'); return false;"><img src="cc-by-sa.png" /></a></td>
			<br>
			<div class="menu-title">Search</div>
			<form action="search.php" method="get" id="search">
				<fieldset>
					<input class="search" type="text" name="q" value="Quick Search..." onfocus="this.value='';" />
				</fieldset>
			</form>
		</div>
	</div>
	<div class="content-container">
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="Doc_DeveloperDocumentation.html">Developer Documentation</a></li><li class="navelem"><a class="el" href="Doc_DeveloperTutorials.html">Developer tutorials</a></li><li class="navelem"><a class="el" href="Doc_DeveloperDocumentation_Plugin.html">Developing a Plugin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Implementing a signal processing algorithm </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="important"> This documentation page is deprecated since <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> 0.12.0 (oct 2011), and won't be maintained.  The new page can be found  <a href="http://openvibe.inria.fr/tutorial-1-implementing-a-signal-processing-box/"> here </a> .</div><ul>
<li><b>NB:</b> Document based on <b> <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> 0.8.0 </b> (30-sep-2010).</li>
</ul>
<p>This section of the tutorial presents a detailed implementation of the signal processing algorithm. It is made of two distinct parts : the <a class="el" href="Doc_Tutorial_Developer_SignalProcessing_Algorithm.html#Doc_Tutorial_Developer_SignalProcessing_AlgorithmHeader">Algorithm definition</a> (c++ header file) and the <a class="el" href="Doc_Tutorial_Developer_SignalProcessing_Algorithm.html#Doc_Tutorial_Developer_SignalProcessing_AlgorithmImplementation">Algorithm implementation</a> (c++ cpp file).</p>
<h1><a class="anchor" id="Doc_Tutorial_Developer_SignalProcessing_AlgorithmHeader"></a>
Algorithm definition</h1>
<p>Here is the file containing the algorithm definition, we will detail each line of the file later on.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef __OpenViBEPlugins_Algorithm_SignalProcessingAlgorithm_H__</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define __OpenViBEPlugins_Algorithm_SignalProcessingAlgorithm_H__</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#include &quot;../../ovp_defines.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openvibe/ov_all.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openvibe-toolkit/ovtk_all.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define OVP_ClassId_Algorithm_SignalProcessingAlgorithm     OpenViBE::CIdentifier(0x3B7523EC, 0x16C30A39)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_ClassId_Algorithm_SignalProcessingAlgorithmDesc OpenViBE::CIdentifier(0x11BE2168, 0x5B494BBB)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix  OpenViBE::CIdentifier(0x56154223, 0x42180588)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_OutputParameterId_Matrix OpenViBE::CIdentifier(0x023A4450, 0x6DFD17DB)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize  OpenViBE::CIdentifier(0x01803B07, 0x667A69BC)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process     OpenViBE::CIdentifier(0x661A59C0, 0x12FB7F74)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_ProcessDone OpenViBE::CIdentifier(0x33802521, 0x785D51FD)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>OpenViBEPlugins</div>
<div class="line">{</div>
<div class="line">        <span class="keyword">namespace </span>Samples</div>
<div class="line">        {</div>
<div class="line">                <span class="keyword">class </span>CAlgorithmSignalProcessingAlgorithm : <span class="keyword">public</span> OpenViBEToolkit::TAlgorithm &lt; OpenViBE::Plugins::IAlgorithm &gt;</div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <span class="keywordtype">void</span> release(<span class="keywordtype">void</span>) { <span class="keyword">delete</span> <span class="keyword">this</span>; }</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> initialize(<span class="keywordtype">void</span>);</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> uninitialize(<span class="keywordtype">void</span>);</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> process(<span class="keywordtype">void</span>);</div>
<div class="line"></div>
<div class="line">                        _IsDerivedFromClass_Final_(OpenViBEToolkit::TAlgorithm &lt; OpenViBE::Plugins::IAlgorithm &gt;, OVP_ClassId_Algorithm_SignalProcessingAlgorithm);</div>
<div class="line"></div>
<div class="line">                <span class="keyword">protected</span>:</div>
<div class="line"></div>
<div class="line">                        <a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html">OpenViBE::Kernel::TParameterHandler &lt; OpenViBE::IMatrix* &gt;</a> ip_pMatrix;</div>
<div class="line">                        <a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html">OpenViBE::Kernel::TParameterHandler &lt; OpenViBE::IMatrix* &gt;</a> op_pMatrix;</div>
<div class="line">                };</div>
<div class="line"></div>
<div class="line">                <span class="keyword">class </span>CAlgorithmSignalProcessingAlgorithmDesc : <span class="keyword">public</span> <a class="code" href="classOpenViBE_1_1Plugins_1_1IAlgorithmDesc.html" title="Algorithm plugin descriptorThis class should be derived by any plugin developper in order to describe...">OpenViBE::Plugins::IAlgorithmDesc</a></div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <span class="keywordtype">void</span> release(<span class="keywordtype">void</span>) { }</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getName(<span class="keywordtype">void</span>)<span class="keyword"> const                </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;Signal processing algorithm&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getAuthorName(<span class="keywordtype">void</span>)<span class="keyword"> const          </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;Yann Renard&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getAuthorCompanyName(<span class="keywordtype">void</span>)<span class="keyword"> const   </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;INRIA&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getShortDescription(<span class="keywordtype">void</span>)<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;This is a sample signal processing algorithm that does nothing but can be used as a quick start for creating new signal processing algorithms&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getDetailedDescription(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getCategory(<span class="keywordtype">void</span>)<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;Samples&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getVersion(<span class="keywordtype">void</span>)<span class="keyword"> const             </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;1.0&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getStockItemName(<span class="keywordtype">void</span>)<span class="keyword"> const       </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;gtk-execute&quot;</span>); }</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CIdentifier.html" title="Globally used identifiaction classThis class is the basic class to use in order to identify objects i...">OpenViBE::CIdentifier</a> getCreatedClass(<span class="keywordtype">void</span>)<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> OVP_ClassId_Algorithm_SignalProcessingAlgorithm; }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObject.html" title="Base class for plugin objectThis class is the base class for all the concrete plugin classes that ext...">OpenViBE::Plugins::IPluginObject</a>* create(<span class="keywordtype">void</span>)       { <span class="keywordflow">return</span> <span class="keyword">new</span> OpenViBEPlugins::Samples::CAlgorithmSignalProcessingAlgorithm; }</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> getAlgorithmPrototype(</div>
<div class="line">                                <a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html" title="Prototype interface for algorithm.">OpenViBE::Kernel::IAlgorithmProto</a>&amp; rAlgorithmPrototype)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">                        </span>{</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a22c963a12a98208724f6b14de9e62ccb" title="Adds an input parameter.">addInputParameter</a> (OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix,     <span class="stringliteral">&quot;Matrix&quot;</span>, <a class="code" href="namespaceOpenViBE_1_1Kernel.html#a7ecb353db1f50558c21c6c6beeefe20ca715393494754db64d1aafc6f37fc269c" title="Matrix pointer parameter.">OpenViBE::Kernel::ParameterType_Matrix</a>);</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a751e79ac44638aefaedc1b301b7a7e55" title="Adds an output parameter.">addOutputParameter</a>(OVP_Algorithm_SignalProcessingAlgorithm_OutputParameterId_Matrix,    <span class="stringliteral">&quot;Matrix&quot;</span>, <a class="code" href="namespaceOpenViBE_1_1Kernel.html#a7ecb353db1f50558c21c6c6beeefe20ca715393494754db64d1aafc6f37fc269c" title="Matrix pointer parameter.">OpenViBE::Kernel::ParameterType_Matrix</a>);</div>
<div class="line"></div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a9c295abbada936be780fe65a4dac7046" title="Adds an input trigger.">addInputTrigger</a>   (OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize,   <span class="stringliteral">&quot;Initialize&quot;</span>);</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a9c295abbada936be780fe65a4dac7046" title="Adds an input trigger.">addInputTrigger</a>   (OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process,      <span class="stringliteral">&quot;Process&quot;</span>);</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#acedad38883200cf5e3991182f77c74f4" title="Adds an output trigger.">addOutputTrigger</a>  (OVP_Algorithm_SignalProcessingAlgorithm_OutputTriggerId_ProcessDone, <span class="stringliteral">&quot;Process done&quot;</span>);</div>
<div class="line"></div>
<div class="line">                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                        _IsDerivedFromClass_Final_(<a class="code" href="classOpenViBE_1_1Plugins_1_1IAlgorithmDesc.html" title="Algorithm plugin descriptorThis class should be derived by any plugin developper in order to describe...">OpenViBE::Plugins::IAlgorithmDesc</a>, OVP_ClassId_Algorithm_SignalProcessingAlgorithmDesc);</div>
<div class="line">                };</div>
<div class="line">        };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif // __OpenViBEPlugins_Algorithm_SignalProcessingAlgorithm_H__</span></div>
</div><!-- fragment --> <p>First of all, we will include every identifier / define needed for this plugin to work. The <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> toolkit will help in the implementation so we include it as well. <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;../../ovp_defines.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openvibe/ov_all.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openvibe-toolkit/ovtk_all.h&gt;</span></div>
</div><!-- fragment --></p>
<p>The next part defines all the unique CIdentifier objects that identify the algorithm, the algorithm descriptor, and all the inputs, outputs and triggers. These random identifiers can be generated randomly using the dedicated tool <b>id-generator</b>, provided by the <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> software platform. Please be sure to use <b>unique</b> identifiers. <div class="fragment"><div class="line"></div>
<div class="line"><span class="preprocessor">#define OVP_ClassId_Algorithm_SignalProcessingAlgorithm     OpenViBE::CIdentifier(0x3B7523EC, 0x16C30A39)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_ClassId_Algorithm_SignalProcessingAlgorithmDesc OpenViBE::CIdentifier(0x11BE2168, 0x5B494BBB)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix  OpenViBE::CIdentifier(0x56154223, 0x42180588)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_OutputParameterId_Matrix OpenViBE::CIdentifier(0x023A4450, 0x6DFD17DB)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize  OpenViBE::CIdentifier(0x01803B07, 0x667A69BC)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process     OpenViBE::CIdentifier(0x661A59C0, 0x12FB7F74)</span></div>
<div class="line"><span class="preprocessor">#define OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_ProcessDone OpenViBE::CIdentifier(0x33802521, 0x785D51FD)</span></div>
</div><!-- fragment --></p>
<p>In order to avoid name collisions, it is a safe practice to include all classes in a namespace. All standard <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> plugins are defined in sub namespaces of OpenViBEPlugins. Here we are going to build a new box for example purposes, so we narrow down the scope to the Samples sub namespace. <div class="fragment"><div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>OpenViBEPlugins</div>
<div class="line">{</div>
<div class="line">        <span class="keyword">namespace </span>Samples</div>
<div class="line">        {</div>
</div><!-- fragment --></p>
<p>Now that we are in the OpenViBEPlugins::Samples namespace, we have to define the classes making up the algorithm :</p>
<ul>
<li>the algorithm itself, and</li>
<li>its associated descriptor.</li>
</ul>
<p>The descriptor is retrieved by the kernel upon startup. It provides information about the algorithm and also allows to create instances of this algorithm.</p>
<p>We start by declaring the algorithm class.</p>
<p>First off, we must choose an appropriate class name. Since this example algorithm is meant to be a general signal processing example, we use a general name. In practice, the name of an algorithm should always convey a rough idea of what kind of signal processing it performs.</p>
<p>The interface common to all algorithms is IAlgorithm. Our algorithm must therefore inherit from it to be identified as a proper algorithm. However, algorithms implementation is made easier by the OpenViBEToolkit::TAlgorithm template, which implements several functionalities common to all algorithms (e.g. direct access to managers). Therefore, we inherit from this template, using the required IAlgorithm interface as the template argument.</p>
<p>The first method to implement is release, which deletes the algorithm. <div class="fragment"><div class="line">                <span class="keyword">class </span>CAlgorithmSignalProcessingAlgorithm : <span class="keyword">public</span> OpenViBEToolkit::TAlgorithm &lt; OpenViBE::Plugins::IAlgorithm &gt;</div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <span class="keywordtype">void</span> release(<span class="keywordtype">void</span>) { <span class="keyword">delete</span> <span class="keyword">this</span>; }</div>
</div><!-- fragment --></p>
<p>The gist of an algorithm implementation lies in three methods : initialize, uninitialize and process. Here is the life cycle of an algorithm :</p>
<ul>
<li>the algorithm is created (using the algorithm descriptor)</li>
<li>initialize is called once</li>
<li>process is called an indefinite number of times</li>
<li>uninitialize is called once</li>
<li>the algorithm is deleted</li>
</ul>
<p>Each of these methods returns a boolean reflecting whether they operated successfully. If any of them returns false, the caller should assume the algorithm failed and should stop calling this algorithm any further. <div class="fragment"><div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> initialize(<span class="keywordtype">void</span>);</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> uninitialize(<span class="keywordtype">void</span>);</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> process(<span class="keywordtype">void</span>);</div>
</div><!-- fragment --></p>
<p>All <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> classes have their own class identifier. Once a new identifier has been generated, one should associate it to the algorithm class using the <em>IsDerivedFromClass_Final</em> macro. The first argument of the macro is the name of the parent class, the second is the algorithm identifier. <div class="fragment"><div class="line"></div>
<div class="line">                        _IsDerivedFromClass_Final_(OpenViBEToolkit::TAlgorithm &lt; OpenViBE::Plugins::IAlgorithm &gt;, OVP_ClassId_Algorithm_SignalProcessingAlgorithm);</div>
<div class="line"></div>
<div class="line">                <span class="keyword">protected</span>:</div>
</div><!-- fragment --></p>
<p>In this simple example, we are going to design an algorithm that takes a single input parameter (a matrix) and produces a single output parameter (another matrix).</p>
<p>In order to facilitate parameters usage, the algorithm should embed its parameters in parameter handlers. Parameter handlers provide transparent access to embedded parameters using an interface similar to the parameter interface. <div class="fragment"><div class="line"></div>
<div class="line">                        <a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html">OpenViBE::Kernel::TParameterHandler &lt; OpenViBE::IMatrix* &gt;</a> ip_pMatrix;</div>
<div class="line">                        <a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html">OpenViBE::Kernel::TParameterHandler &lt; OpenViBE::IMatrix* &gt;</a> op_pMatrix;</div>
<div class="line">                };</div>
</div><!-- fragment --></p>
<p>The algorithm definition is now complete, and we move on to its descriptor. The algorithm descriptor provides information as to the role of its associated algorithm, its author, version, category and so on.</p>
<p>The interface common to all algorithm descriptors is IAlgorithmDesc, which we inherit from.</p>
<p>The release function can be left empty since a single instance of any given descriptor is created by the plugin which contains it, at plugin loading time, and eventually destroyed by the plugin when it is unloaded.</p>
<p>A number of methods return description strings which can be used to get a general idea of what the algorithm consists in.</p>
<p><div class="fragment"><div class="line"></div>
<div class="line">                <span class="keyword">class </span>CAlgorithmSignalProcessingAlgorithmDesc : <span class="keyword">public</span> <a class="code" href="classOpenViBE_1_1Plugins_1_1IAlgorithmDesc.html" title="Algorithm plugin descriptorThis class should be derived by any plugin developper in order to describe...">OpenViBE::Plugins::IAlgorithmDesc</a></div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#ab71139e4a1b8906698bcc32a69360a53" title="Informs the plugin description it won&#39;t be used any more.">release</a>(<span class="keywordtype">void</span>) { }</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#a58cb70c15580108bedcf540854d9da01" title="Gets the plugin name.">getName</a>(<span class="keywordtype">void</span>)<span class="keyword"> const                </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;Signal processing algorithm&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#ae47e6cb8ad014125db6f72117dd4f4f1" title="Gets the author name for this plugin.">getAuthorName</a>(<span class="keywordtype">void</span>)<span class="keyword"> const          </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;Yann Renard&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#adc55205aaad5af5a5684d9add4d28e41" title="Gets the author company name for this plugin.">getAuthorCompanyName</a>(<span class="keywordtype">void</span>)<span class="keyword"> const   </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;INRIA&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#a377d3eea1634f4ca54abd33dbc323435" title="Gets a short description of the plugin.">getShortDescription</a>(<span class="keywordtype">void</span>)<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;This is a sample signal processing algorithm that does nothing but can be used as a quick start for creating new signal processing algorithms&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#a4be5a3a4c1842b9327e3e662e166aef2" title="Gets a detailed description of the plugin.">getDetailedDescription</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#a2a65e302b88c41afbf07ea438cc1ad03" title="Gets a basic category of the plugin.">getCategory</a>(<span class="keywordtype">void</span>)<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;Samples&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObjectDesc.html#a34035e82f3ad033c9d3ead17bc6e594b" title="Gets the version of the plugin.">getVersion</a>(<span class="keywordtype">void</span>)<span class="keyword"> const             </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;1.0&quot;</span>); }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a> getStockItemName(<span class="keywordtype">void</span>)<span class="keyword"> const       </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenViBE_1_1CString.html" title="String class to avoid std::string in the interfaceThis class helps avoiding std::string being present...">OpenViBE::CString</a>(<span class="stringliteral">&quot;gtk-execute&quot;</span>); }</div>
</div><!-- fragment --></p>
<p>The descriptor specifies what kind of algorithm it is able to create thanks to the getCreatedClass method, which returns the name of the algorithm class. Actual instances of the algorithm may be created using the create method. <div class="fragment"><div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1CIdentifier.html" title="Globally used identifiaction classThis class is the basic class to use in order to identify objects i...">OpenViBE::CIdentifier</a> getCreatedClass(<span class="keywordtype">void</span>)<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> OVP_ClassId_Algorithm_SignalProcessingAlgorithm; }</div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="classOpenViBE_1_1Plugins_1_1IPluginObject.html" title="Base class for plugin objectThis class is the base class for all the concrete plugin classes that ext...">OpenViBE::Plugins::IPluginObject</a>* create(<span class="keywordtype">void</span>)       { <span class="keywordflow">return</span> <span class="keyword">new</span> OpenViBEPlugins::Samples::CAlgorithmSignalProcessingAlgorithm; }</div>
</div><!-- fragment --></p>
<p>The algorithm prototype may be retrieved using getAlgorithmPrototype. The prototype gives information about inputs, outputs and triggers.</p>
<p>Inputs and outputs are parameters and can easily be manipulated with parameter handlers. Triggers are related to the algorithm state : input triggers specify how the algorithm should execute when called, while output triggers give an indication of what state the algorithm ended in when done with processing. <div class="fragment"><div class="line"></div>
<div class="line">                        <span class="keyword">virtual</span> <a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> getAlgorithmPrototype(</div>
<div class="line">                                <a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html" title="Prototype interface for algorithm.">OpenViBE::Kernel::IAlgorithmProto</a>&amp; rAlgorithmPrototype)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">                        </span>{</div>
</div><!-- fragment --></p>
<p>This signal processing algorithm has two parameters : one input containing the signal matrix to process and one output containing the processed signal. Each of these parameters is identified by an identifier, a name and a type. <div class="fragment"><div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a22c963a12a98208724f6b14de9e62ccb" title="Adds an input parameter.">addInputParameter</a> (OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix,     <span class="stringliteral">&quot;Matrix&quot;</span>, <a class="code" href="namespaceOpenViBE_1_1Kernel.html#a7ecb353db1f50558c21c6c6beeefe20ca715393494754db64d1aafc6f37fc269c" title="Matrix pointer parameter.">OpenViBE::Kernel::ParameterType_Matrix</a>);</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a751e79ac44638aefaedc1b301b7a7e55" title="Adds an output parameter.">addOutputParameter</a>(OVP_Algorithm_SignalProcessingAlgorithm_OutputParameterId_Matrix,    <span class="stringliteral">&quot;Matrix&quot;</span>, <a class="code" href="namespaceOpenViBE_1_1Kernel.html#a7ecb353db1f50558c21c6c6beeefe20ca715393494754db64d1aafc6f37fc269c" title="Matrix pointer parameter.">OpenViBE::Kernel::ParameterType_Matrix</a>);</div>
</div><!-- fragment --></p>
<p>This signal processing algorithm also has three triggers.</p>
<p>The first one is an input trigger and is used to notify the algorithm that the initialization step could be performed. This initialization is different from the one done in initialize : when the latter method is called, the algorithm itself is initialized, whereas the former method initializes data the algorithm will process later on. Preconditions that must be validated before activating this trigger include :</p>
<ul>
<li>The algorithm initialize method returned successfully</li>
</ul>
<ul>
<li>The input matrix description was filled</li>
</ul>
<p>The second trigger also is an input trigger. When set, it requests the actual processing of the input matrix and results in the production of an output matrix.</p>
<p>The last trigger is an output trigger used to tell the caller about the outcome of the signal processing stage. When and only when an output matrix is successfully produced, the algorithm activates this output trigger. <div class="fragment"><div class="line"></div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a9c295abbada936be780fe65a4dac7046" title="Adds an input trigger.">addInputTrigger</a>   (OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize,   <span class="stringliteral">&quot;Initialize&quot;</span>);</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#a9c295abbada936be780fe65a4dac7046" title="Adds an input trigger.">addInputTrigger</a>   (OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process,      <span class="stringliteral">&quot;Process&quot;</span>);</div>
<div class="line">                                rAlgorithmPrototype.<a class="code" href="classOpenViBE_1_1Kernel_1_1IAlgorithmProto.html#acedad38883200cf5e3991182f77c74f4" title="Adds an output trigger.">addOutputTrigger</a>  (OVP_Algorithm_SignalProcessingAlgorithm_OutputTriggerId_ProcessDone, <span class="stringliteral">&quot;Process done&quot;</span>);</div>
</div><!-- fragment --></p>
<p>Finally, the method returns true, notifying the caller (the kernel) that the box prototype was successfully retrieved. <div class="fragment"><div class="line"></div>
<div class="line">                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                        }</div>
</div><!-- fragment --></p>
<p>Similarly to how we associated an identifier to the algorithm class, we specify the identifier of the algorithm descriptor using the <em>IsDerivedFromClass_Final</em> macro. The first argument is algorithm descriptor's parent interface and the second is the actual descriptor identifier. <div class="fragment"><div class="line"></div>
<div class="line">                        _IsDerivedFromClass_Final_(<a class="code" href="classOpenViBE_1_1Plugins_1_1IAlgorithmDesc.html" title="Algorithm plugin descriptorThis class should be derived by any plugin developper in order to describe...">OpenViBE::Plugins::IAlgorithmDesc</a>, OVP_ClassId_Algorithm_SignalProcessingAlgorithmDesc);</div>
<div class="line">                };</div>
<div class="line">        };</div>
<div class="line">};</div>
</div><!-- fragment --></p>
<h1><a class="anchor" id="Doc_Tutorial_Developer_SignalProcessing_AlgorithmImplementation"></a>
Algorithm implementation</h1>
<p>Here is the file containing the algorithm implementation, we will detail each line of the file later on.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;ovpCAlgorithmSignalProcessingAlgorithm.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>OpenViBE;</div>
<div class="line"><span class="keyword">using namespace </span>OpenViBE::Kernel;</div>
<div class="line"><span class="keyword">using namespace </span>OpenViBE::Plugins;</div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>OpenViBEPlugins;</div>
<div class="line"><span class="keyword">using namespace </span>OpenViBEPlugins::Samples;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">boolean</span> CAlgorithmSignalProcessingAlgorithm::initialize(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        ip_pMatrix.<a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html#a7511aca374e126f43beb7879d57699c7" title="Connects this parameter handler to a concrete IParameter pointer.">initialize</a>(this-&gt;getInputParameter(OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix));</div>
<div class="line">        op_pMatrix.initialize(this-&gt;getOutputParameter(OVP_Algorithm_SignalProcessingAlgorithm_OutputParameterId_Matrix));</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">boolean</span> CAlgorithmSignalProcessingAlgorithm::uninitialize(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        op_pMatrix.uninitialize();</div>
<div class="line">        ip_pMatrix.<a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html#a3c4612264cb495eb776e7a70aabea9b7" title="Disconnects this parameter handler from its concrete IParameter pointer.">uninitialize</a>();</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">boolean</span> CAlgorithmSignalProcessingAlgorithm::process(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        <a class="code" href="classOpenViBE_1_1IMatrix.html" title="Basic §OpenViBE§ matrix interface.">IMatrix</a>* l_pInputMatrix=ip_pMatrix;</div>
<div class="line">        <a class="code" href="classOpenViBE_1_1IMatrix.html" title="Basic §OpenViBE§ matrix interface.">IMatrix</a>* l_pOutputMatrix=op_pMatrix;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(this-&gt;isInputTriggerActive(OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize))</div>
<div class="line">        {</div>
<div class="line">                OpenViBEToolkit::Tools::Matrix::copyDescription(*l_pOutputMatrix, *l_pInputMatrix);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(this-&gt;isInputTriggerActive(OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process))</div>
<div class="line">        {</div>
<div class="line">                OpenViBEToolkit::Tools::Matrix::copyContent(*l_pOutputMatrix, *l_pInputMatrix);</div>
<div class="line">                <span class="keywordflow">for</span>(<a class="code" href="namespaceOpenViBE.html#a1134b580f8da4de94ca6b1de4d37975e" title="32 bits unsigned integer">uint32</a> i=0; i&lt;l_pInputMatrix-&gt;<a class="code" href="classOpenViBE_1_1IMatrix.html#a922ef58b1fba834b423edfd90ac14671" title="Gets the dimension size for a given dimension index.">getDimensionSize</a>(0); i++)</div>
<div class="line">                {</div>
<div class="line">                        l_pOutputMatrix-&gt;<a class="code" href="classOpenViBE_1_1IMatrix.html#a3dfcbceff9c8c87c4b15ae561837f6d6" title="Gets the raw buffer for this matrix.">getBuffer</a>()[i*l_pInputMatrix-&gt;<a class="code" href="classOpenViBE_1_1IMatrix.html#a922ef58b1fba834b423edfd90ac14671" title="Gets the dimension size for a given dimension index.">getDimensionSize</a>(1)]=0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                this-&gt;activateOutputTrigger(OVP_Algorithm_SignalProcessingAlgorithm_OutputTriggerId_ProcessDone, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> <p>First off, for easier development, it is common practice to declare using several common <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> namespaces at the beginning of the file, after including the required header files. A good rule of thumb is to never use "using" directives in header files, and to use them sparsely in implementation files. Considering <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> does not contain conflicting classes (no two classes are named identically among all its files), it is acceptable to declare using <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> namespaces. <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;ovpCAlgorithmSignalProcessingAlgorithm.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>OpenViBE;</div>
<div class="line"><span class="keyword">using namespace </span>OpenViBE::Kernel;</div>
<div class="line"><span class="keyword">using namespace </span>OpenViBE::Plugins;</div>
</div><!-- fragment --></p>
<p>Similarly, the OpenViBEPlugins project does not contain conflicting classes and makes it acceptable to declare using some of its namespaces. <div class="fragment"><div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>OpenViBEPlugins;</div>
<div class="line"><span class="keyword">using namespace </span>OpenViBEPlugins::Samples;</div>
</div><!-- fragment --></p>
<p>On to the real meat of the implementation : there are three algorithm methods two implement,and the good news is that two of them are simple :)</p>
<p>In this example, initialize and uninitialize simply consist in connecting or disconnecting our parameter handlers to the actual parameters. These handlers will be used later to ease parameter value manipulation.</p>
<p>Let's initialize our parameters. <div class="fragment"><div class="line"></div>
<div class="line"><span class="keywordtype">boolean</span> CAlgorithmSignalProcessingAlgorithm::initialize(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
</div><!-- fragment --></p>
<p>ip_pMatrix is the input matrix pointer used by this algorithm. This parameter was declared in the algorithm descriptor as being of type OV_TypeId_Matrix and identified as OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix. The parameter can be retrieved with the getInputParameter function and passed to the handler using its initialize method.</p>
<p>Past this point, ip_pMatrix can be used as the object it encapsulates, that is, as an IMatrix* pointer using the -&gt; operator. <div class="fragment"><div class="line">        ip_pMatrix.<a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html#a7511aca374e126f43beb7879d57699c7" title="Connects this parameter handler to a concrete IParameter pointer.">initialize</a>(this-&gt;getInputParameter(OVP_Algorithm_SignalProcessingAlgorithm_InputParameterId_Matrix));</div>
</div><!-- fragment --></p>
<p>Similarly, op_pMatrix is the output matrix pointer of this algorithm. The parameter can be retrieved with the getOutputParameter function and given to the handler. Past this point, op_pMatrix can be used as an IMatrix* pointer using the -&gt; operator. <div class="fragment"><div class="line">        op_pMatrix.initialize(this-&gt;getOutputParameter(OVP_Algorithm_SignalProcessingAlgorithm_OutputParameterId_Matrix));</div>
</div><!-- fragment --></p>
<p>Returning true at the end of this initialize function tells the kernel everything went on nicely and no error occurred. If false is returned here, the kernel will consider this algorithm failed to initialize and won't call it anymore in the future. <div class="fragment"><div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --></p>
<p>Uninitialize should be called to terminate an algorithm which won't be used anymore. Thus, every initialized member should be freed and the whole environment should be left as it was before initialize was called. In this simple example, all that is needed is to disconnect our parameter handlers from their respective parameters. <div class="fragment"><div class="line"></div>
<div class="line"><span class="keywordtype">boolean</span> CAlgorithmSignalProcessingAlgorithm::uninitialize(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
</div><!-- fragment --></p>
<p>op_pMatrix can be disconnected from its parameter thanks to the uninitialize method. Past this point, using operator -&gt; will throw an exception and cause a crash. <div class="fragment"><div class="line">        op_pMatrix.uninitialize();</div>
</div><!-- fragment --></p>
<p>The same can be done with ip_pMatrix. <div class="fragment"><div class="line">        ip_pMatrix.<a class="code" href="classOpenViBE_1_1Kernel_1_1TParameterHandler.html#a3c4612264cb495eb776e7a70aabea9b7" title="Disconnects this parameter handler from its concrete IParameter pointer.">uninitialize</a>();</div>
</div><!-- fragment --></p>
<p>As in initialize, returning true notifies the kernel everything ran smoothly. <div class="fragment"><div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --></p>
<p>Now all that is left to implement is the core of the algorithm, the process method which does the actual signal processing. This method is called each time operations should be performed by this algorithm.</p>
<p>What operations the algorithm should execute may be specified using input triggers. Every time process is called, the algorithm should check the state of its input triggers and deduce what computations to perform. At the end of the processing, the algorithm can reflect its status by setting the appropriate output triggers. <div class="fragment"><div class="line"></div>
<div class="line"><span class="keywordtype">boolean</span> CAlgorithmSignalProcessingAlgorithm::process(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
</div><!-- fragment --></p>
<p>First of all, we will retrieve input and output matrix pointers from the parameter handlers. Since our handler instances were templated with IMatrix*, there is an automatic cast operator that returns a pointer to the actual IMatrix* value. <div class="fragment"><div class="line">        IMatrix* l_pInputMatrix=ip_pMatrix;</div>
<div class="line">        IMatrix* l_pOutputMatrix=op_pMatrix;</div>
</div><!-- fragment --></p>
<p>Now, we have to examine each of the input triggers to know what to process. Those input triggers are declared in the algorithm prototype. In this case, there are two of them, namely OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize and OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process. Let's check whether the first one is activated</p>
<p><div class="fragment"><div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(this-&gt;isInputTriggerActive(OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Initialize))</div>
<div class="line">        {</div>
</div><!-- fragment --></p>
<p>When the initialize trigger is active, we know that the input matrix contains a complete description of the input matrices that will be forwarded to this algorithm (number of dimensions, dimension sizes, labels...).</p>
<p>Since our processing function only changes some matrix values, the description of its output matrix is identical to that of its input matrix. Therefore, we copy it using the copyDescription helper function of the toolkit. Past this point, the output matrix will have the same aspect as the input matrix. However, its contents are undefined for now. <div class="fragment"><div class="line">                OpenViBEToolkit::Tools::Matrix::copyDescription(*l_pOutputMatrix, *l_pInputMatrix);</div>
<div class="line">        }</div>
</div><!-- fragment --></p>
<p>*Let's now test whether the process input trigger is set. <div class="fragment"><div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(this-&gt;isInputTriggerActive(OVP_Algorithm_SignalProcessingAlgorithm_InputTriggerId_Process))</div>
<div class="line">        {</div>
</div><!-- fragment --></p>
<p>When this particular trigger is active, we know that the input matrix is completely filled, including its buffer (the part of the matrix that contains values). This is where the actual processing can take place. As an example, we demonstrate how to copy the input signal buffer, slightly modifying it by changing only the first sample of each channel by setting it to 0.</p>
<p>Input matrices are assumed to be two dimensional, and the samples of a given channel are listed in a row before moving on to the next channel.</p>
<ul>
<li>the first dimension (index 0) of the matrix represents the number of channels</li>
<li>the second dimension (index 1) is made up of the samples of any given channel</li>
</ul>
<p>The getBuffer method returns a pointer to the first value of the matrix, that is, the first sample of the first channel. To access the jth sample of the ith channel, one must offset this pointer by the following formula :</p>
<p>i * sampleCount + j</p>
<p>where sampleCount is the number of samples per channel, given by the size of the second dimension (index 1).</p>
<p>In this example, we iterate over channels (i) and set their first sample (j == 0) to 0. <div class="fragment"><div class="line">                OpenViBEToolkit::Tools::Matrix::copyContent(*l_pOutputMatrix, *l_pInputMatrix);</div>
<div class="line">                <span class="keywordflow">for</span>(uint32 i=0; i&lt;l_pInputMatrix-&gt;getDimensionSize(0); i++)</div>
<div class="line">                {</div>
<div class="line">                        l_pOutputMatrix-&gt;getBuffer()[i*l_pInputMatrix-&gt;getDimensionSize(1)]=0;</div>
<div class="line">                }</div>
</div><!-- fragment --></p>
<p>Now that the processing is done, this can be reflected to the caller by activating the "process done" output trigger, whose state will be checked by the caller. Therefore, the OVP_Algorithm_SignalProcessingAlgorithm_OutputTriggerId_ProcessDone output trigger is activated. <div class="fragment"><div class="line"></div>
<div class="line">                this-&gt;activateOutputTrigger(OVP_Algorithm_SignalProcessingAlgorithm_OutputTriggerId_ProcessDone, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
</div><!-- fragment --></p>
<p>Finally, we should return true to notify the kernel that no error occurred during this processing step. If false is returned, the kernel won't ever call this algorithm anymore. <div class="fragment"><div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --></p>
<p>Now please go on to the final step : <a class="el" href="Doc_Tutorial_Developer_SignalProcessing_Box.html">Implementing a Box</a> </p>
</div></div><!-- contents -->
	</div>
	<div class='clear-both'></div>
	<div id="footer">
		<center>
		<table width=95%>
			<tr>
				<td style="text-align:left;"><a href="#page-top">Back to top</a></td>
				<td style="text-align:right;">Generated on Fri Sep 26 2014 00:47:34 for Documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.1.2</td>
			</tr>
		</table>
		</center>
	</div>
</div>
</body>
</html>
