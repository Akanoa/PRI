<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OpenViBE documentation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<!-- <link href="tabs.css" rel="stylesheet" type="text/css"> -->
</head>
<body>
<div id="main">
	<div id="title">
		<center>
		<a name="page-top"></a>
		<table width=95%>
			<tr>
				<td><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;"><img src="logo.png" /></a></td>
				<td width=100%>OpenViBE Documentation</td>
			</tr>
		</table>
		</center>
	</div>
	<div id="menu">
		<div id="menu-content">
			<ul>
				<li><a href="index.html">OpenViBE Documentation</a></li>
			</ul>
			<div class="menu-title">Doxygen</div>
			<ul>
				<!-- <li><a href="pages.html">Related</a></li> -->
				<li><a href="modules.html">Modules</a></li>
				<li><a href="namespaces.html">Namespaces</a></li>
				<li><a href="annotated.html">Class List</a>
				<li><a href="classes.html">Class Index</a>
				<li><a href="hierarchy.html">Class Hierarchy</a>
				<!-- <li><a href="files.html">Files (buggy)</a></li> -->
			</ul>
			<div class="menu-title">Quick Access</div>
			<ul>
				<li><a href="http://openvibe.inria.fr/start" class="leaving-link">Video Tutorials</a></li>
				<li><a href="http://openvibe.inria.fr/faq">FAQ</a></li>
				<li><a href="http://openvibe.inria.fr/license">Licence</a></li>
				<li><a href="http://openvibe.inria.fr/build-instructions/">Build Instructions</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#User+Documentation">User Doc</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#Developer+Documentation">Developer Doc</a></li>
				<li><a href="Doc_BoxAlgorithms.html">Exisiting Boxes</a></li>
			</ul>
			<div class="menu-title">Contact</div>
			<ul>
				<li><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;">Software Home</a></li>
				<li><a href="http://openvibe.inria.fr/forum" class="leaving-link" onclick="window.open(this.href,'openvibe-forum'); return false;">Forum</a></li>
				<li><a href="https://gforge.inria.fr/projects/openvibe" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">INRIA gForge</a></li>
				<li><a href="https://gforge.inria.fr/mail/?group_id=276" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">Mailing Lists</a></li>
				<li><a href="http://openvibe.inria.fr/tracker" class="leaving-link" onclick="window.open(this.href,'openvibe-tracker'); return false;">Bug Tracker</a></li>
				<li><a href="http://www.irisa.fr/bunraku/OpenViBE/wiki/index.php?title=Main_Page" class="leaving-link" onclick="window.open(this.href,'openvibe-wiki'); return false;">Research Project</a></li>
				<li><b>IRC</b> : <span style="font-size: x-small; font-style: italic;">#openvibe</span> on <span style="font-size: x-small; font-style: italic;">irc.freenode.net</span></li>
				<li><b>Project Leader</b> : Anatole L&eacute;cuyer, Inria <span style="font-size: x-small; font-style: italic;">(anatole dot lecuyer at inria dot fr)</span></li>
				<li><b>Lead Software Engineer</b> : Laurent Bonnet, Inria <span style="font-size: x-small; font-style: italic;">(laurent dot bonnet at inria dot fr)</span></li>
			</ul>
			<div class="menu-title">Share this</div>
			<ul><li><span style="font-size: x-small; font-style: italic;">This documentation is licenced under <b>CC-BY-SA</b></span></li></ul>
			<td><a href="http://creativecommons.org/licenses/by-sa/3.0/legalcode" class="leaving-link" onclick="window.open(this.href,'cc-by-sa'); return false;"><img src="cc-by-sa.png" /></a></td>
			<br>
			<div class="menu-title">Search</div>
			<form action="search.php" method="get" id="search">
				<fieldset>
					<input class="search" type="text" name="q" value="Quick Search..." onfocus="this.value='';" />
				</fieldset>
			</form>
		</div>
	</div>
	<div class="content-container">
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="Doc_DeveloperDocumentation.html">Developer Documentation</a></li><li class="navelem"><a class="el" href="Doc_DeveloperTutorials.html">Developer tutorials</a></li><li class="navelem"><a class="el" href="Doc_DeveloperDocumentation_Driver.html">Developing a Driver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial: Using the built-in Impedance Checker </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="important"> This documentation page is deprecated since <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> 0.12.0 (oct 2011), and won't be maintained.  The new page can be found  <a href="http://openvibe.inria.fr/tutorial-using-the-built-in-impedance-checker/"> here </a> .</div><ul>
<li><b>NB:</b> Tutorial based on <b> <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> 0.6.1 </b> (20-may-2010).</li>
</ul>
<h1><a class="anchor" id="Doc_DriverImpedanceChecker_Introduction"></a>
Introduction</h1>
<p>The <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a> framework provides some mechanisms to improve your acquisition drivers. These services are given by the IDriverContext. One of them is the Impedance Checker : If your device is capable of giving impedance values you can give them to the impedance checker, and in few lines of code you will have real-time feedback on the impedance of the electrodes when you connect the driver.</p>
<p>This tutorial covers this optional mechanism, how it works and how to integrate it in your driver.</p>
<h1><a class="anchor" id="Doc_DriverImpedanceChecker_Warning"></a>
Warning</h1>
<p>In order to use properly the impedance checker, you have to be sure that :</p>
<ul>
<li>Your acquisition device has an "Impedance" mode</li>
<li>The device and/or the electrodes <b>won't be damaged</b> by using the impedance acquisition mode</li>
</ul>
<p>Among the devices currently available in <a class="el" href="namespaceOpenViBE.html" title="Main OpenViBE namespace.">OpenViBE</a>, the g.Tec gUSBAmp and the Micromed SD LTM can acquire impedance values of each electrode connected. The MindMedia NeXus32B can't. It has been reported that some models of active electrode do not support impedance mode or can be damaged if the impedance acquisition is used too long or too many times. We strongly recommend you to check the full documentation of your device, and/or ask the manufacturer if any questions remain.</p>
<h1><a class="anchor" id="Doc_DriverImpedanceChecker_Implementation"></a>
Implementation</h1>
<p>Let's take an example, with a dummy driver CDriverFooBarDevice. We assume that the FooBarDevice can handle impedance mode, and that the API provides a function that gives the impedance value of a given channel.</p>
<h2><a class="anchor" id="Doc_DriverImpedanceChecker_Implementation_1"></a>
Impedance or not impedance ?</h2>
<p>The basic configuration provides a dedicated token, that you can use to check if the user wants to use the impedance checker. The <a class="el" href="Doc_ConfigurationManager.html">Configuration manager</a> gives you access to that token. </p>
<div class="fragment"><div class="line">CDriverFooBarDevice::CDriverFooBarDevice(IDriverContext&amp; rDriverContext)</div>
<div class="line"> :IDriver(rDriverContext)</div>
<div class="line"> ,m_pCallback(NULL)</div>
<div class="line"> ,m_ui32SampleCountPerSentBlock(0)</div>
<div class="line"> {</div>
<div class="line"> <span class="comment">//... set sampling frequency, channel count, etc.</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">// We get the token &quot;AcquisitionServer_CheckImpedance&quot;, </span></div>
<div class="line"> <span class="comment">// if not found it will be &quot;false&quot;</span></div>
<div class="line"> m_bImpedanceCheck =</div>
<div class="line">     m_rDriverContext</div>
<div class="line">      .getConfigurationManager()</div>
<div class="line">       .expandAsBoolean(</div>
<div class="line">                 <span class="stringliteral">&quot;${AcquisitionServer_CheckImpedance}&quot;</span>,</div>
<div class="line">                 <span class="keyword">false</span>);</div>
<div class="line"> m_rDriverContext</div>
<div class="line">     .getLogManager() &lt;&lt; LogLevel_Trace </div>
<div class="line">                      &lt;&lt; (m_bImpedanceCheck?</div>
<div class="line">                          <span class="stringliteral">&quot;Impedance will be checked&quot;</span></div>
<div class="line">                         :<span class="stringliteral">&quot;Impedance won&#39;t be checked&quot;</span>) </div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> }</div>
</div><!-- fragment --><h2><a class="anchor" id="Doc_DriverImpedanceChecker_Implementation_2"></a>
Update the impedance values</h2>
<p>To enable the visual feedback of the impedance checker, you just need to give the IDriverContext the impedance values of a given channel. You should call this function only when the driver is initialized and not started. Read the full documentation of IDriverContext for further details. </p>
<div class="fragment"><div class="line"><a class="code" href="namespaceOpenViBE.html#af29b166bf5fea7f0bbc07f7014a8c6b5" title="Boolean.">OpenViBE::boolean</a> updateImpedance(</div>
<div class="line">   <span class="keyword">const</span> <a class="code" href="namespaceOpenViBE.html#a1134b580f8da4de94ca6b1de4d37975e" title="32 bits unsigned integer">OpenViBE::uint32</a>     ui32ChannelIndex, </div>
<div class="line">   <span class="keyword">const</span> <a class="code" href="namespaceOpenViBE.html#a232fad1b0d6dcc7c16aabde98b2e2a80" title="64 bits floating point">OpenViBE::float64</a>    f64Impedance)</div>
</div><!-- fragment --><p>We will call this function in the driver main loop, at the right time.</p>
<div class="fragment"><div class="line"><span class="keywordtype">boolean</span> CDriverGTecGUSBamp::loop(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span>(!m_rDriverContext.isConnected()) </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(m_rDriverContext.isStarted())</div>
<div class="line">  {</div>
<div class="line">        <span class="comment">//... Get the data from hardware, </span></div>
<div class="line">    <span class="comment">// fill the buffer, maybe correct a jitter, etc.</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">//connected, but not started : let&#39;s check the impedance </span></div>
<div class="line">    <span class="keywordflow">if</span>(m_bImpedanceCheck)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">for</span>(uint32 i = 0; i &lt; m_oHeader.getChannelCount(); i++)</div>
<div class="line">      {</div>
<div class="line">        <span class="comment">// we get the impedance of each channel</span></div>
<div class="line">        <span class="keywordtype">double</span> l_dImpedance = FooBarAPI::getImpedance(i);</div>
<div class="line">        <span class="comment">// and update the driver context with it</span></div>
<div class="line">        m_rDriverContext.updateImpedance(i, l_dImpedance);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>In this example we assumed that the call to the API <code>FooBarAPI::getImpedance(i)</code> returns a value in a nearly instantaneous time. If the device needs more time the program will hang for few seconds in the loop, maybe more. For example, the g.Tec gUSBamp needs 1 second for each call. In this case, you can ask for the impedance value of only one channel, and change the channel in every <code>loop()</code> call. Please look at <code>ovasCDriverGTecGUSBamp.cpp</code> for further details. </p>
</div></div><!-- contents -->
	</div>
	<div class='clear-both'></div>
	<div id="footer">
		<center>
		<table width=95%>
			<tr>
				<td style="text-align:left;"><a href="#page-top">Back to top</a></td>
				<td style="text-align:right;">Generated on Fri Sep 26 2014 00:47:34 for Documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.1.2</td>
			</tr>
		</table>
		</center>
	</div>
</div>
</body>
</html>
