<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OpenViBE documentation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<!-- <link href="tabs.css" rel="stylesheet" type="text/css"> -->
</head>
<body>
<div id="main">
	<div id="title">
		<center>
		<a name="page-top"></a>
		<table width=95%>
			<tr>
				<td><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;"><img src="logo.png" /></a></td>
				<td width=100%>OpenViBE Documentation</td>
			</tr>
		</table>
		</center>
	</div>
	<div id="menu">
		<div id="menu-content">
			<ul>
				<li><a href="index.html">OpenViBE Documentation</a></li>
			</ul>
			<div class="menu-title">Doxygen</div>
			<ul>
				<!-- <li><a href="pages.html">Related</a></li> -->
				<li><a href="modules.html">Modules</a></li>
				<li><a href="namespaces.html">Namespaces</a></li>
				<li><a href="annotated.html">Class List</a>
				<li><a href="classes.html">Class Index</a>
				<li><a href="hierarchy.html">Class Hierarchy</a>
				<!-- <li><a href="files.html">Files (buggy)</a></li> -->
			</ul>
			<div class="menu-title">Quick Access</div>
			<ul>
				<li><a href="http://openvibe.inria.fr/start" class="leaving-link">Video Tutorials</a></li>
				<li><a href="http://openvibe.inria.fr/faq">FAQ</a></li>
				<li><a href="http://openvibe.inria.fr/license">Licence</a></li>
				<li><a href="http://openvibe.inria.fr/build-instructions/">Build Instructions</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#User+Documentation">User Doc</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#Developer+Documentation">Developer Doc</a></li>
				<li><a href="Doc_BoxAlgorithms.html">Exisiting Boxes</a></li>
			</ul>
			<div class="menu-title">Contact</div>
			<ul>
				<li><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;">Software Home</a></li>
				<li><a href="http://openvibe.inria.fr/forum" class="leaving-link" onclick="window.open(this.href,'openvibe-forum'); return false;">Forum</a></li>
				<li><a href="https://gforge.inria.fr/projects/openvibe" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">INRIA gForge</a></li>
				<li><a href="https://gforge.inria.fr/mail/?group_id=276" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">Mailing Lists</a></li>
				<li><a href="http://openvibe.inria.fr/tracker" class="leaving-link" onclick="window.open(this.href,'openvibe-tracker'); return false;">Bug Tracker</a></li>
				<li><a href="http://www.irisa.fr/bunraku/OpenViBE/wiki/index.php?title=Main_Page" class="leaving-link" onclick="window.open(this.href,'openvibe-wiki'); return false;">Research Project</a></li>
				<li><b>IRC</b> : <span style="font-size: x-small; font-style: italic;">#openvibe</span> on <span style="font-size: x-small; font-style: italic;">irc.freenode.net</span></li>
				<li><b>Project Leader</b> : Anatole L&eacute;cuyer, Inria <span style="font-size: x-small; font-style: italic;">(anatole dot lecuyer at inria dot fr)</span></li>
				<li><b>Lead Software Engineer</b> : Laurent Bonnet, Inria <span style="font-size: x-small; font-style: italic;">(laurent dot bonnet at inria dot fr)</span></li>
			</ul>
			<div class="menu-title">Share this</div>
			<ul><li><span style="font-size: x-small; font-style: italic;">This documentation is licenced under <b>CC-BY-SA</b></span></li></ul>
			<td><a href="http://creativecommons.org/licenses/by-sa/3.0/legalcode" class="leaving-link" onclick="window.open(this.href,'cc-by-sa'); return false;"><img src="cc-by-sa.png" /></a></td>
			<br>
			<div class="menu-title">Search</div>
			<form action="search.php" method="get" id="search">
				<fieldset>
					<input class="search" type="text" name="q" value="Quick Search..." onfocus="this.value='';" />
				</fieldset>
			</form>
		</div>
	</div>
	<div class="content-container">
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Home</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Formating <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> streams </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Doc_FormatingEBMLStreams_Introduction"></a>
Introduction</h1>
<p>This page tries to teach how a user of this library should use the writing functions in order to build and format an <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> stream correctly. For those who don't know what <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> is, it is basically a binary XML created and used by the matroska developpers. The libmatroska is based on the libebml implementation of these guys. Fore more details, please read the <a class="el" href="Doc_WhatIsEBML.html">What is EBML</a> page first and eventually visit the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> web page at <a href="http://ebml.sourceforge.net/">http://ebml.sourceforge.net/</a></p>
<h1><a class="anchor" id="Doc_FormatingEBMLStreams_Concept"></a>
Concepts</h1>
<p>The idea of this formating library is to transform the data provided by the user application into <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> buffers. Those <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> buffers are then given to a user callback object which know what to do with the computed data (maybe write it to a file, send it on a socket, log it in a console, whatever...)</p>
<p>The library is divided into three main components :</p>
<ul>
<li>The writer itself that does the formating stuff</li>
<li>An implementation of the callback object (the implementation is left to the user application developper)</li>
<li>An optionnal helper object that knows more on the content of the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> stream.</li>
</ul>
<p>Here comes the organisation of the different modules and how data go from one to another. Note that the user application and the user callback object may share some information so the callback object communicates with the application itself.</p>
<div class="image">
<img src="ebml_formating_concept.png" alt="ebml_formating_concept.png"/>
<div class="caption">
Concept</div></div>
<p> Here comes the UML class diagram, presenting the main classes involved in the presented behavior.</p>
<div class="image">
<img src="ebml_formating_class.png" alt="ebml_formating_class.png"/>
<div class="caption">
Class Diagram</div></div>
<p> See <a class="el" href="classEBML_1_1IWriter.html" title="EBML formating class.">EBML::IWriter</a>, <a class="el" href="classEBML_1_1IWriterCallback.html" title="Callback class to use when creating the EBML stream.">EBML::IWriterCallback</a> and <a class="el" href="classEBML_1_1IWriterHelper.html" title="Helper to write basic EBML types.">EBML::IWriterHelper</a> for more details on each of these classes.</p>
<h1><a class="anchor" id="Doc_FormatingEBMLStreams_SampleCode"></a>
Sample code</h1>
<p>In this section, a sample of user application code is presented that opens several child nodes and dumps the created stream into a file for later use. This file can be parsed using the sample code of the page named <a class="el" href="Doc_ParsingEBMLStreams.html">Parsing EBML streams</a></p>
<p>The callback object implementation looks something like this :</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>CWriterCallback : <span class="keyword">public</span> <a class="code" href="classEBML_1_1IWriterCallback.html" title="Callback class to use when creating the EBML stream.">EBML::IWriterCallback</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  CWriterCallback(<span class="keywordtype">char</span>* sFileName)</div>
<div class="line">  {</div>
<div class="line">    m_pFile=fopen(sFileName, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> ~CWriterCallback(<span class="keywordtype">void</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(m_pFile) fclose(m_pFile);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classEBML_1_1IWriterCallback.html#a6e13abfed7bf04d4084b36038ac08099" title="Gives the callback object a new stream chunk.">write</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* pBuffer, <span class="keyword">const</span> <a class="code" href="namespaceEBML.html#a29940ae63ec06c9998bba873e25407ad" title="64 bits unsigned integer">EBML::uint64</a> ui64BufferSize)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(m_pFile) fwrite(pBuffer, ui64BufferSize, 1, m_pFile);</div>
<div class="line">  }</div>
<div class="line">  FILE* m_pFile;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Then in the user application code, we can write the initialisation this way :</p>
<div class="fragment"><div class="line">CWriterCallback oCallback(<span class="stringliteral">&quot;test.ebml&quot;</span>);</div>
<div class="line"><a class="code" href="classEBML_1_1IWriter.html" title="EBML formating class.">EBML::IWriter</a>* pWriter=<a class="code" href="namespaceEBML.html#a13a7bf90d72fa6147a4f99cfd09720e9" title="Instanciation function for EBML writer objects.">EBML::createWriter</a>(oCallback);</div>
<div class="line"><a class="code" href="classEBML_1_1IWriterHelper.html" title="Helper to write basic EBML types.">EBML::IWriterHelper</a>* pWriterHelper=<a class="code" href="namespaceEBML.html#a9e72b5dacfb24472870127cb8f749368" title="Instanciation function for EBML writer helper objects.">EBML::createWriterHelper</a>();</div>
<div class="line">pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#a7ac6ff99548ed89c2a658b28526ce339" title="Connects an EBML writer to this helper.">connect</a>(pWriter);</div>
</div><!-- fragment --><p>The use of the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> writer looks something like this :</p>
<div class="fragment"><div class="line">pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#a46e3df599e9860099cc4f095f326d7dd" title="Child opening binding.">openChild</a>(EBML_Identifier_Header);</div>
<div class="line">  pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#a46e3df599e9860099cc4f095f326d7dd" title="Child opening binding.">openChild</a>(EBML_Identifier_DocType);</div>
<div class="line">    pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#a7b980c7bb9996d2f58a549ba9470f0a5" title="Sets an ASCII string as child data.">setASCIIStringAsChildData</a>(<span class="stringliteral">&quot;EBML basic sample&quot;</span>);</div>
<div class="line">  pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#af5bc98c288c4baf12a8b6933005fe68d" title="Child closing binding.">closeChild</a>();</div>
<div class="line">  pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#a46e3df599e9860099cc4f095f326d7dd" title="Child opening binding.">openChild</a>(EBML_Identifier_DocTypeVersion);</div>
<div class="line">    pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#ae0eb166c0cce0ed49a7b14dfdb486d27" title="Sets an unsigned integer as child data.">setUIntegerAsChildData</a>(1);</div>
<div class="line">  pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#af5bc98c288c4baf12a8b6933005fe68d" title="Child closing binding.">closeChild</a>();</div>
<div class="line">pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#af5bc98c288c4baf12a8b6933005fe68d" title="Child closing binding.">closeChild</a>();</div>
</div><!-- fragment --><p>Finally, we have to release the objects and to clean memory :</p>
<div class="fragment"><div class="line">pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#a5910a2b0bf1f2a68f8302c5e19d6ce82" title="Disconnects the currently connected EBML writer.">disconnect</a>();</div>
<div class="line">pWriterHelper-&gt;<a class="code" href="classEBML_1_1IWriterHelper.html#ab71139e4a1b8906698bcc32a69360a53" title="Tells this object it won&#39;t be used anymore.">release</a>();</div>
<div class="line">pWriter-&gt;<a class="code" href="classEBML_1_1IWriter.html#ab71139e4a1b8906698bcc32a69360a53" title="Tells this object it won&#39;t be used anymore.">release</a>();</div>
</div><!-- fragment --> </div></div><!-- contents -->
	</div>
	<div class='clear-both'></div>
	<div id="footer">
		<center>
		<table width=95%>
			<tr>
				<td style="text-align:left;"><a href="#page-top">Back to top</a></td>
				<td style="text-align:right;">Generated on Fri Sep 26 2014 00:47:34 for Documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.1.2</td>
			</tr>
		</table>
		</center>
	</div>
</div>
</body>
</html>
