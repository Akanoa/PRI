<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OpenViBE documentation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<!-- <link href="tabs.css" rel="stylesheet" type="text/css"> -->
</head>
<body>
<div id="main">
	<div id="title">
		<center>
		<a name="page-top"></a>
		<table width=95%>
			<tr>
				<td><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;"><img src="logo.png" /></a></td>
				<td width=100%>OpenViBE Documentation</td>
			</tr>
		</table>
		</center>
	</div>
	<div id="menu">
		<div id="menu-content">
			<ul>
				<li><a href="index.html">OpenViBE Documentation</a></li>
			</ul>
			<div class="menu-title">Doxygen</div>
			<ul>
				<!-- <li><a href="pages.html">Related</a></li> -->
				<li><a href="modules.html">Modules</a></li>
				<li><a href="namespaces.html">Namespaces</a></li>
				<li><a href="annotated.html">Class List</a>
				<li><a href="classes.html">Class Index</a>
				<li><a href="hierarchy.html">Class Hierarchy</a>
				<!-- <li><a href="files.html">Files (buggy)</a></li> -->
			</ul>
			<div class="menu-title">Quick Access</div>
			<ul>
				<li><a href="http://openvibe.inria.fr/start" class="leaving-link">Video Tutorials</a></li>
				<li><a href="http://openvibe.inria.fr/faq">FAQ</a></li>
				<li><a href="http://openvibe.inria.fr/license">Licence</a></li>
				<li><a href="http://openvibe.inria.fr/build-instructions/">Build Instructions</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#User+Documentation">User Doc</a></li>
				<li><a href="http://openvibe.inria.fr/documentation-index/#Developer+Documentation">Developer Doc</a></li>
				<li><a href="Doc_BoxAlgorithms.html">Exisiting Boxes</a></li>
			</ul>
			<div class="menu-title">Contact</div>
			<ul>
				<li><a href="http://openvibe.inria.fr" class="leaving-link" onclick="window.open(this.href,'openvibe-software'); return false;">Software Home</a></li>
				<li><a href="http://openvibe.inria.fr/forum" class="leaving-link" onclick="window.open(this.href,'openvibe-forum'); return false;">Forum</a></li>
				<li><a href="https://gforge.inria.fr/projects/openvibe" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">INRIA gForge</a></li>
				<li><a href="https://gforge.inria.fr/mail/?group_id=276" class="leaving-link" onclick="window.open(this.href,'openvibe-forge'); return false;">Mailing Lists</a></li>
				<li><a href="http://openvibe.inria.fr/tracker" class="leaving-link" onclick="window.open(this.href,'openvibe-tracker'); return false;">Bug Tracker</a></li>
				<li><a href="http://www.irisa.fr/bunraku/OpenViBE/wiki/index.php?title=Main_Page" class="leaving-link" onclick="window.open(this.href,'openvibe-wiki'); return false;">Research Project</a></li>
				<li><b>IRC</b> : <span style="font-size: x-small; font-style: italic;">#openvibe</span> on <span style="font-size: x-small; font-style: italic;">irc.freenode.net</span></li>
				<li><b>Project Leader</b> : Anatole L&eacute;cuyer, Inria <span style="font-size: x-small; font-style: italic;">(anatole dot lecuyer at inria dot fr)</span></li>
				<li><b>Lead Software Engineer</b> : Laurent Bonnet, Inria <span style="font-size: x-small; font-style: italic;">(laurent dot bonnet at inria dot fr)</span></li>
			</ul>
			<div class="menu-title">Share this</div>
			<ul><li><span style="font-size: x-small; font-style: italic;">This documentation is licenced under <b>CC-BY-SA</b></span></li></ul>
			<td><a href="http://creativecommons.org/licenses/by-sa/3.0/legalcode" class="leaving-link" onclick="window.open(this.href,'cc-by-sa'); return false;"><img src="cc-by-sa.png" /></a></td>
			<br>
			<div class="menu-title">Search</div>
			<form action="search.php" method="get" id="search">
				<fieldset>
					<input class="search" type="text" name="q" value="Quick Search..." onfocus="this.value='';" />
				</fieldset>
			</form>
		</div>
	</div>
	<div class="content-container">
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Home</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Parsing <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> streams </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Doc_ParsingEBMLStreams_Introduction"></a>
Introduction</h1>
<p>This page tries to teach how a user of this library should use the reading functions in order to read and parse an <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> stream correctly. For those who don't know what <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> is, it is basically a binary XML created and used by the matroska developpers. The libmatroska is based on the libebml implementation of these guys. Fore more details, please read the <a class="el" href="Doc_WhatIsEBML.html">What is EBML</a> page first and eventually visit the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> web page at <a href="http://ebml.sourceforge.net/">http://ebml.sourceforge.net/</a></p>
<h1><a class="anchor" id="Doc_ParsingEBMLStreams_Concept"></a>
Concepts</h1>
<p>The idea of this parsing library is to transform the stream data provided by the user application into understandable <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> interpreted commands. Once the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> nodes are found and parsed, they are sent to a callback object that should know what to do with them.</p>
<p>The design of the parsing interface is closed to the one of <code>eXpat</code>, an XML parser library (see <a href="http://expat.sourceforge.net">http://expat.sourceforge.net</a> for more details on <code>eXpat</code>). Using such interface allows light code and on-the-fly parsing, that means the parser does not need to have all the data ready before starting the parsing process... The data can arrive while the parsing is beeing done.</p>
<p>It is the responsability of the user application to read the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> stream from a file, a socket, a user input or whatever, and then to send this to the parser...</p>
<p>At least, the callback object may use a reader helper that knows how to read standard <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> types such as integers, floats, strings etc...</p>
<p>The library is divided into three main components :</p>
<ul>
<li>The reader itself that does the parsing stuffs</li>
<li>An implementation of the callback object (the implementation is left to the user application developper)</li>
<li>An optionnal helper object that knows more on the content of the <a class="el" href="namespaceEBML.html" title="Namespace for the EBML lib.">EBML</a> stream.</li>
</ul>
<p>Here comes the organisation of the different modules and how data go from one to another. Note that the user application and the user callback object may share some information so the callback object communicates with the application itself.</p>
<div class="image">
<img src="ebml_parsing_concept.png" alt="ebml_parsing_concept.png"/>
<div class="caption">
Concept</div></div>
<p> Here comes the UML class diagram, presenting the main classes involved in the presented behavior.</p>
<div class="image">
<img src="ebml_parsing_class.png" alt="ebml_parsing_class.png"/>
<div class="caption">
Class Diagram</div></div>
<p> See <a class="el" href="classEBML_1_1IReader.html" title="EBML processing class.">EBML::IReader</a>, <a class="el" href="classEBML_1_1IReaderCallback.html" title="Callback class to use when parsing the EBML stream.">EBML::IReaderCallback</a> and <a class="el" href="classEBML_1_1IReaderHelper.html" title="Helper to read basic EBML types.">EBML::IReaderHelper</a> for more details on each of these classes.</p>
<h1><a class="anchor" id="Doc_ParsingEBMLStreams_SampleCode"></a>
Sample code</h1>
<p>In this section, a sample of user application code is presented that parses the sample file created in the page named : <a class="el" href="Doc_FormatingEBMLStreams.html">Formating EBML streams</a></p>
<p>The parsed value are printed in the console.</p>
<p>The callback object looks something like this :</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>CReaderCallback : <span class="keyword">public</span> <a class="code" href="classEBML_1_1IReaderCallback.html" title="Callback class to use when parsing the EBML stream.">EBML::IReaderCallback</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  CReaderCallback(<span class="keywordtype">void</span>)</div>
<div class="line">  {</div>
<div class="line">    m_pReaderHelper=<a class="code" href="namespaceEBML.html#adf635b3190e144be0c11120af3a4444b" title="Instanciation function for EBML reader helper objects.">EBML::createReaderHelper</a>();</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> ~CReaderCallback(<span class="keywordtype">void</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(m_pReaderHelper) m_pReaderHelper-&gt;release();</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classEBML_1_1IReaderCallback.html#a98c6f25aba7e5b0f42b9b3f373c62304" title="Kind of child querry.">isMasterChild</a>(<span class="keyword">const</span> <a class="code" href="classEBML_1_1CIdentifier.html" title="Base class to work with EBML identifiers.">EBML::CIdentifier</a>&amp; rIdentifier)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(rIdentifier==EBML_Identifier_Header) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>(rIdentifier==EBML_Identifier_DocType) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">if</span>(rIdentifier==EBML_Identifier_DocTypeVersion) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classEBML_1_1IReaderCallback.html#aaf1a25756baf1aadd66586d8f46c89cc" title="Informs the callback object a new node parsing is starting.">openChild</a>(<span class="keyword">const</span> <a class="code" href="classEBML_1_1CIdentifier.html" title="Base class to work with EBML identifiers.">EBML::CIdentifier</a>&amp; rIdentifier)</div>
<div class="line">  {</div>
<div class="line">    m_oCurrent=rIdentifier;</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classEBML_1_1IReaderCallback.html#a6b19e04ec285f3f8c972c01ccb9761d6" title="Gives the callback object the data associated with the currently opened child node.">processChildData</a>(cosnt <span class="keywordtype">void</span>* pBuffer, <span class="keyword">const</span> <a class="code" href="namespaceEBML.html#a29940ae63ec06c9998bba873e25407ad" title="64 bits unsigned integer">EBML::uint64</a> ui64BufferSize)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(m_oCurrent==EBML_Identifier_DocType)</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Doc type:&quot;</span> &lt;&lt; m_pReaderHelper-&gt;getASCIIStringFromChildData(pBuffer, ui64BufferSize) &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">if</span>(m_oCurrent==EBML_Identifier_DocTypeVersion)</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Dox type version:&quot;</span> &lt;&lt; m_pReaderHelper-&gt;getUIntegerFromChildData(pBuffer, ui64BufferSize) &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classEBML_1_1IReaderCallback.html#a8277982e73e691fcbffc2dbe74c35b18" title="Informs the callback object the current node parsing is terminated.">closeChild</a>(<span class="keywordtype">void</span>)</div>
<div class="line">  {</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="classEBML_1_1IReaderHelper.html" title="Helper to read basic EBML types.">EBML::IReaderHelper</a>* m_pReaderHelper;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Then in the user application code, we can write the initialisation this way :</p>
<div class="fragment"><div class="line">CReaderCallback oCallback;</div>
<div class="line"><a class="code" href="classEBML_1_1IReader.html" title="EBML processing class.">EBML::IReader</a>* pReader=<a class="code" href="namespaceEBML.html#afbe8c28f42b86b6bc9c5fd2eae2963d7" title="Instanciation function for EBML reader objects.">EBML::createReader</a>(oCallback);</div>
</div><!-- fragment --><p>Now suppose the user application got some data from the file in a <code>pBuffer</code> of size <code>ui64BufferSize</code> ; it is sent to the parser this way :</p>
<div class="fragment"><div class="line">pReader-&gt;<a class="code" href="classEBML_1_1IReader.html#a87693225acaba9c4d2168b36eef1bac8" title="Processes a chunk of data.">processData</a>(pBuffer, ui64BufferSize);</div>
</div><!-- fragment --><p>Finally, don't forget to release the object and to clean memory :</p>
<div class="fragment"><div class="line">pReader-&gt;<a class="code" href="classEBML_1_1IReader.html#ab71139e4a1b8906698bcc32a69360a53" title="Tells this object it won&#39;t be used anymore.">release</a>();</div>
</div><!-- fragment --> </div></div><!-- contents -->
	</div>
	<div class='clear-both'></div>
	<div id="footer">
		<center>
		<table width=95%>
			<tr>
				<td style="text-align:left;"><a href="#page-top">Back to top</a></td>
				<td style="text-align:right;">Generated on Fri Sep 26 2014 00:47:34 for Documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.1.2</td>
			</tr>
		</table>
		</center>
	</div>
</div>
</body>
</html>
